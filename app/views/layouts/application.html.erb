<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "CareKonek University" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
      body {
        margin: 0;
        padding-top: 56px;
        background-color: #f8f9fa;
      }

      .top-navbar {
        background-color: #004a99;
        color: white;
        font-weight: 600;
        font-size: 1.25rem;
        height: 56px;
        display: flex;
        align-items: center;
        padding-left: 25px;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1030;
      }

      .sidebar {
        position: fixed;
        top: 56px;
        left: 0;
        bottom: 0;
        width: 250px;
        background: linear-gradient(to bottom, #052659, #5483B3, #7DA0CA);
        color: white;
        overflow-x: hidden;
        z-index: 1000;
      }

      .sidebar .nav-link {
        display: flex;
        align-items: center;
        color: #ffffff;
        padding: 10px 15px;
        border-radius: 7px;
        transition: background 0.2s, color 0.2s;
      }

      .sidebar .nav-link i {
        font-size: 1.3rem;
        margin-right: 15px;
        min-width: 30px;
        text-align: center;
      }

      .sidebar .nav-link i:hover {
        color: #ffd700;
        text-shadow: 0 0 10px #ffd700, 0 0 20px #ffd700, 0 0 30px #ffd700;
      }

      .sidebar .nav-link span {
        opacity: 1;
        visibility: visible;
        white-space: nowrap;
      }

      .sidebar .nav-link:hover,
      .sidebar .nav-link.active {
        background-color: #5483b3;
        color: white;
      }

      .sidebar .nav-link.active i {
        color: #efbf04;
      }

      .sidebar .school-section {
        text-align: center;
        padding: 1rem 0;
        border-bottom: 1px solid rgba(255,255,255,0.2);
      }

      .sidebar .school-section img {
        width: 120px;
        height: 120px;
        border-radius: 50%;
      }

      .sidebar .school-section span {
        display: block;
        margin-top: 0.5rem;
        font-size: 0.8rem;
        opacity: 1;
      }

      .main-content {
        margin-left: 250px;
        padding: 1.5rem;
      }
    </style>
  </head>

  <body>
    <nav class="top-navbar">
      mySchoolManager
    </nav>

    <nav class="sidebar d-flex flex-column py-3">
      <div class="school-section">
        <%= image_tag "carekoneklogo.png", alt: "School Logo" %>
        <span>CareKonek University</span>
      </div>

      <ul class="nav flex-column mt-3">
        <li>
          <%= link_to students_path, class: "nav-link #{'active' if controller_name == 'students'}" do %>
            <i class="bi bi-mortarboard-fill"></i>
            <span>Students</span>
          <% end %>
        </li>
        <li>
          <%= link_to subjects_path, class: "nav-link #{'active' if controller_name == 'subjects'}" do %>
            <i class="bi bi-book-half"></i>
            <span>Subjects</span>
          <% end %>
        </li>
        <li>
          <%= link_to sections_path, class: "nav-link #{'active' if controller_name == 'sections'}" do %>
            <i class="bi bi-diagram-3"></i>
            <span>Sections</span>
          <% end %>
        </li>
        <li>
          <%= link_to classlists_path, class: "nav-link #{'active' if controller_name == 'classlists'}" do %>
            <i class="bi bi-list-check"></i>
            <span>Class List</span>
          <% end %>
        </li>
        <li>
          <%= link_to teachers_path, class: "nav-link #{'active' if controller_name == 'teachers'}" do %>
            <i class="bi bi-person-video3"></i>
            <span>Teachers</span>
          <% end %>
        </li>
        <li>
          <%= link_to staffs_path, class: "nav-link #{'active' if controller_name == 'staffs'}" do %>
            <i class="bi bi-person-badge-fill"></i>
            <span>Staffs</span>
          <% end %>
        </li>
        <li>
          <%= link_to departments_path, class: "nav-link #{'active' if controller_name == 'departments'}" do %>
            <i class="bi bi-bank2"></i>
            <span>Departments</span>
          <% end %>
        </li>
        <li>
          <%= link_to guardians_path, class: "nav-link #{'active' if controller_name == 'guardians'}" do %>
            <i class="bi bi-person-heart"></i>
            <span>Guardians</span>
          <% end %>
        </li>
        <li>
          <%= link_to student_guardians_path, class: "nav-link #{'active' if controller_name == 'student_guardians'}" do %>
            <i class="bi bi-link-45deg"></i>
            <span>Student-Guardians</span>
          <% end %>
        </li>
      </ul>
    </nav>

    <div class="main-content">
      <% flash.each do |key, message| %>
        <div class="alert alert-<%= key == "notice" ? "success" : "danger" %> alert-dismissible fade show" role="alert">
          <%= message %>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      <% end %>

      <div class="bg-white p-4 rounded-4 shadow-sm">
        <%= yield %>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content shadow-sm border border-danger-subtle p-2">
      <div class="modal-header border-0 py-1">
        <button type="button" class="btn-close ms-auto" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body text-center py-2">
        <div class="d-flex align-items-center justify-content-center gap-3">
          <i class="bi bi-exclamation-triangle-fill text-danger fs-2"></i>
          <div class="text-start">
            <p class="mb-1 fw-semibold">Are you sure you want to delete this student?</p>
            <p class="text-secondary small mb-0">
              This student will be deleted immediately. You can't undo this action.
            </p>
          </div>
        </div>
      </div>

      <div class="modal-footer justify-content-center border-0 pt-1 pb-2">
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
        <form id="deleteStudentForm" method="post" data-turbo="false" class="d-inline">
          <input type="hidden" name="_method" value="delete">
          <button type="submit" class="btn btn-danger btn-sm">Delete</button>
        </form>
      </div>
    </div>
  </div>
</div>